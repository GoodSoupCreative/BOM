{"ast":null,"code":"import _objectSpread from\"/Users/joshuaadams/Documents/BOM/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/Users/joshuaadams/Documents/BOM/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";var _excluded=[\"component\"];import React,{memo}from\"react\";import{Redirect,Route}from\"react-router-dom\";import{useUser}from'./Hooks/useUser';import AdminLogin from'./../Admin/Pages/Login';//loop through users current assigned roles and match to modules\nimport{jsx as _jsx}from\"react/jsx-runtime\";function CheckPermissions(roles,module){var passedChecks=false;//console.log(module);\n//admin role checks so auto pass for any module\nif(roles!==null&&roles!==void 0&&roles.find(function(role){return role.RoleID===8;})||roles!==null&&roles!==void 0&&roles.find(function(role){return role.RoleID===33;})||roles!==null&&roles!==void 0&&roles.find(function(role){return role.RoleID===32;})){return passedChecks=true;}//event admin\nelse if(roles!==null&&roles!==void 0&&roles.find(function(role){return role.RoleID===35;})){//compare path\nreturn module.includes(\"/admin/events\")?passedChecks=true:passedChecks=false;}//checkin admin\nelse if(roles!==null&&roles!==void 0&&roles.find(function(role){return role.RoleID===38;})){return module.includes(\"/admin/checkin\")?passedChecks=true:passedChecks=false;}//finance role???\n}function ProtectedRoute(_ref){var Component=_ref.component,restOfProps=_objectWithoutProperties(_ref,_excluded);var user=useUser();var roles;//console.log(user.Roles);\nvar isAuthorized=false;//check roles against user\nroles=user?JSON.parse(user[\"Roles\"]):null;isAuthorized=CheckPermissions(roles,restOfProps.path);return isAuthorized?/*#__PURE__*/_jsx(Route,_objectSpread(_objectSpread({},restOfProps),{},{render:function render(props){return/*#__PURE__*/_jsx(Component,_objectSpread({},props));}})):/*#__PURE__*/_jsx(Redirect,{to:\"/admin/login?unauthorized=true\",component:/*#__PURE__*/_jsx(AdminLogin,{})});}export default/*#__PURE__*/memo(ProtectedRoute);","map":{"version":3,"sources":["/Users/joshuaadams/Documents/BOM/src/Components/ProtectedRoute.js"],"names":["React","memo","Redirect","Route","useUser","AdminLogin","CheckPermissions","roles","module","passedChecks","find","role","RoleID","includes","ProtectedRoute","Component","component","restOfProps","user","isAuthorized","JSON","parse","path","props"],"mappings":"2RAAA,MAAOA,CAAAA,KAAP,EAAgBC,IAAhB,KAA4B,OAA5B,CACA,OAASC,QAAT,CAAmBC,KAAnB,KAAgC,kBAAhC,CACA,OAASC,OAAT,KAAwB,iBAAxB,CACA,MAAOC,CAAAA,UAAP,KAAuB,wBAAvB,CAEA;2CACA,QAASC,CAAAA,gBAAT,CAA0BC,KAA1B,CAAiCC,MAAjC,CAAwC,CACtC,GAAIC,CAAAA,YAAY,CAAG,KAAnB,CACA;AACA;AACA,GAAGF,KAAK,OAAL,EAAAA,KAAK,SAAL,EAAAA,KAAK,CAAEG,IAAP,CAAY,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACC,MAAL,GAAgB,CAApB,EAAhB,GAA0CL,KAA1C,SAA0CA,KAA1C,WAA0CA,KAAK,CAAEG,IAAP,CAAY,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACC,MAAL,GAAgB,EAApB,EAAhB,CAA1C,EAAqFL,KAArF,SAAqFA,KAArF,WAAqFA,KAAK,CAAEG,IAAP,CAAY,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACC,MAAL,GAAgB,EAApB,EAAhB,CAAxF,CACA,CACG,MAAOH,CAAAA,YAAY,CAAG,IAAtB,CACF,CACD;AAJA,IAKK,IAAGF,KAAH,SAAGA,KAAH,WAAGA,KAAK,CAAEG,IAAP,CAAY,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACC,MAAL,GAAgB,EAApB,EAAhB,CAAH,CACL,CACE;AACA,MAAOJ,CAAAA,MAAM,CAACK,QAAP,CAAgB,eAAhB,EAAmCJ,YAAY,CAAG,IAAlD,CAAyDA,YAAY,CAAG,KAA/E,CACD,CACD;AALK,IAMA,IAAGF,KAAH,SAAGA,KAAH,WAAGA,KAAK,CAAEG,IAAP,CAAY,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACC,MAAL,GAAgB,EAApB,EAAhB,CAAH,CACL,CACE,MAAOJ,CAAAA,MAAM,CAACK,QAAP,CAAgB,gBAAhB,EAAoCJ,YAAY,CAAG,IAAnD,CAA0DA,YAAY,CAAG,KAAhF,CACD,CACD;AAED,CAED,QAASK,CAAAA,cAAT,MAAkE,IAA7BC,CAAAA,SAA6B,MAAxCC,SAAwC,CAAfC,WAAe,0CAChE,GAAMC,CAAAA,IAAI,CAAGd,OAAO,EAApB,CACA,GAAIG,CAAAA,KAAJ,CACA;AACA,GAAIY,CAAAA,YAAY,CAAG,KAAnB,CACA;AACAZ,KAAK,CAAGW,IAAI,CAAGE,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC,OAAD,CAAf,CAAH,CAA+B,IAA3C,CACAC,YAAY,CAAGb,gBAAgB,CAACC,KAAD,CAAQU,WAAW,CAACK,IAApB,CAA/B,CAGA,MAAOH,CAAAA,YAAY,cACjB,KAAC,KAAD,gCACMF,WADN,MAEE,MAAM,CAAE,gBAACM,KAAD,qBACN,KAAC,SAAD,kBAAeA,KAAf,EADM,EAFV,GADiB,cAMZ,KAAC,QAAD,EAAU,EAAE,CAAC,gCAAb,CAA8C,SAAS,cAAE,KAAC,UAAD,IAAzD,EANP,CAOD,CAED,2BAAetB,IAAI,CAACa,cAAD,CAAnB","sourcesContent":["import React, { memo } from \"react\";\nimport { Redirect, Route } from \"react-router-dom\";\nimport { useUser } from './Hooks/useUser'\nimport AdminLogin from './../Admin/Pages/Login'\n\n//loop through users current assigned roles and match to modules\nfunction CheckPermissions(roles, module){\n  let passedChecks = false;\n  //console.log(module);\n  //admin role checks so auto pass for any module\n  if(roles?.find(role => role.RoleID === 8) || roles?.find(role => role.RoleID === 33) || roles?.find(role => role.RoleID === 32)) \n  {\n     return passedChecks = true;\n  }\n  //event admin\n  else if(roles?.find(role => role.RoleID === 35))\n  {\n    //compare path\n    return module.includes(\"/admin/events\") ? passedChecks = true : passedChecks = false;\n  }\n  //checkin admin\n  else if(roles?.find(role => role.RoleID === 38))\n  {\n    return module.includes(\"/admin/checkin\") ? passedChecks = true : passedChecks = false;\n  }\n  //finance role???\n  \n}\n\nfunction ProtectedRoute({ component: Component, ...restOfProps }) {\n  const user = useUser();\n  let roles;\n  //console.log(user.Roles);\n  let isAuthorized = false;\n  //check roles against user\n  roles = user ? JSON.parse(user[\"Roles\"]) : null;\n  isAuthorized = CheckPermissions(roles, restOfProps.path);\n  \n\n  return isAuthorized ?\n    <Route\n      {...restOfProps}\n      render={(props) =>\n        <Component {...props} /> \n      }\n    /> : <Redirect to=\"/admin/login?unauthorized=true\" component={<AdminLogin/>} />\n}\n\nexport default memo(ProtectedRoute);"]},"metadata":{},"sourceType":"module"}